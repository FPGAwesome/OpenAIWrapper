<!-- Special thanks to chatgpt for writing the boilerplate -->
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Chatbot</title>

  <!-- Include jQuery -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

  <!-- Add CSS styles -->
  <style>
    #chat-window {
      height: 300px;
      overflow-y: scroll;
      border: 1px solid #ddd;
      padding: 10px;
    }

    #chat-form {
      margin-top: 10px;
    }

    #user-message {
      width: 80%;
      padding: 5px;
    }

    #send-btn {
      width: 18%;
      padding: 5px;
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
    }

    .message-row {
      margin-bottom: 10px;
    }

    .message-row .message {
      padding: 3px 10px;
      border-radius: 5px;
      display: inline-block;
      max-width: 75%;
      word-wrap: break-word;
    }

    .message-row .timestamp {
      font-size: 12px;
      color: #888;
      margin-left: 10px;
    }

    .message-row .user-message {
      background-color: #f1f1f1;
    }

    .message-row .chatbot-message {
      background-color: #4CAF50;
      color: white;
    }
  </style>

  <!-- Add JavaScript code -->
  <script>
    $(document).ready(function() {

      // Send message to chatbot API
      function sendMessage(text) {
        $.ajax({
          type: 'POST',
          url: '/chatbot',
          data: {'message': text},
          success: handleMessage
        });
      }

      // Handle chatbot response
      function handleMessage(response) {
        var message = $('<div class="message chatbot-message"></div>').text(response.response);
        var timestamp = $('<span class="timestamp"></span>').text(getFormattedTime());
        var row = $('<div class="row message-row"></div>').append(message).append(timestamp);
        $('#chat-window').append(row);
        scrollToBottom();
        $('#user-message').val('');  // Clear input box
        $('#send-btn').removeAttr('disabled');  // Re-enable send button
      }

      // Handle new user message
      $('#chat-form').submit(function(event) {
        event.preventDefault();
        var text = $('#user-message').val();
        var message = $('<div class="message user-message"></div>').text(text);
        var timestamp = $('<span class="timestamp"></span>').text(getFormattedTime());
        var row = $('<div class="row message-row"></div>').append(message).append(timestamp);
        $('#chat-window').append(row);
        scrollToBottom();
        $('#send-btn').attr('disabled', 'disabled');  // Disable send button
        sendMessage(text);
      });

      // Scroll to the bottom of the chat window
      function scrollToBottom() {
        $('#chat-window').scrollTop($('#chat-window')[0].scrollHeight);
      }

      // Get formatted timestamp
      function getFormattedTime() {
        var now = new Date();
        var hours = now.getHours();
        var minutes = now.getMinutes();
        return hours + ':' + minutes;
      }

    });
  </script>
</head>

<body>

  <!-- Chat window -->
  <div id="chat-window"></div>

  <!-- Chat form -->
  <form id="chat-form">
    <input type="text" id="user-message">
    <input type="submit" id="send-btn" value="Send">
  </form>

</body>
</html>